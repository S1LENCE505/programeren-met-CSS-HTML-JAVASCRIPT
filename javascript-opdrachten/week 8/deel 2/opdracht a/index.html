<!DOCTYPE html>
<html lang="nl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welcome Back</title>
</head>

<body>
    <h1 id="msg"></h1>
    <p id="info"></p>
    <button onclick="reset()">Reset</button>

    <script>
        function timeAgo(timestamp) {
            let diff = Date.now() - timestamp;
            let mins = Math.floor(diff / 60000);
            let hrs = Math.floor(diff / 3600000);
            let days = Math.floor(diff / 86400000);
            if (mins < 60) return `${mins} minuten geleden`;
            if (hrs < 24) return `${hrs} uur geleden`;
            return `${days} dagen geleden`;
        }

        let name = localStorage.getItem('name');
        let visits = parseInt(localStorage.getItem('visits')) || 0;
        let last = parseInt(localStorage.getItem('last')) || 0;

        if (!name) {
            name = prompt('Naam?') || 'Bezoeker';
            visits = 1;
            last = Date.now();
            document.getElementById('msg').innerHTML = `Welkom ${name}!`;
        } else {
            last = Date.now();
            visits++;
            document.getElementById('msg').innerHTML = `Welkom ${name}! Je laatste bezoek was op ${new Date(last).toLocaleString('nl-NL')}`;
        }

        localStorage.setItem('name', name);
        localStorage.setItem('visits', visits);
        localStorage.setItem('last', last);
        document.cookie = `name=${name};max-age=99999;path=/`;
        document.cookie = `visits=${visits};max-age=999999;path=/`;
        document.cookie = `last=${last};max-age=999999;path=/`;

        document.getElementById('info').innerHTML = `Bezoeken: ${visits} | Vorig bezoek: ${timeAgo(last)}`;

        function reset() {
            if (confirm('Alles wissen?')) {
                localStorage.clear();
                document.cookie = 'u=;max-age=0;path=/;';
                location.reload();
            }
        }

        // let jSonobj = {
        //     gebruiker:
        // };

        // let jsonString = JSON.stringify(jSonobj);
        // console.log(jsonString);
    </script>
</body>

</html>